---
name: dev-build-fix-ts
description: 在 TypeScript/前端项目构建或类型检查失败时，按文件分组逐条修复错误，每次变更后重新构建验证，三次无效或引入新错误即停止。
---

# Dev Build Fix (TS)

用于 TypeScript/前端项目的构建失败修复流程，强调最小改动、逐条验证与可追踪的错误汇总。

## 何时使用

- `npm run build` / `pnpm build` 报错
- `tsc --noEmit` 报错且需同步修复
- 拉取新代码后构建失败，需快速恢复

## 工作流程（严格顺序）

1. 确认构建命令
   - 查看 `package.json` 的 `scripts.build`
   - 依据锁文件选择包管理器：`pnpm-lock.yaml` → `pnpm`，`package-lock.json` → `npm`
   - 若缺少构建脚本，先向用户确认
2. 运行构建
   - `npm run build` 或 `pnpm build`
3. 解析错误输出
   - 按文件分组
   - 按严重度排序
4. 针对单个错误循环
   - 展示错误上下文（前后 5 行）
   - 解释问题成因
   - 提出修复方案
   - 施加最小改动
   - 重新运行构建
   - 验证该错误已消失
5. 停止条件
   - 修复引入新错误
   - 同一错误连续 3 次仍存在
   - 用户要求暂停

## 输出要求

- 已修复的错误
- 仍未解决的错误
- 新引入的错误（如有）

## 安全与约束

- 一次只修复一个错误
- 仅依据构建输出与上下文判断，不凭空猜测
- 变更保持最小化，避免跨模块隐式耦合
- 关键信息缺失时先向用户澄清
