---
name: dev-architecture-critic
description: 全栈架构找茬与改进方向评审。用于评审/设计/重构时，识别架构风险、边界问题、DDD 建模缺陷、模块化耦合、数据一致性与演进问题，覆盖现代 Python 后端与前端应用，并按严重度输出问题清单与改进方向。
---

# 架构找茬（全栈）

## 概述

用最少假设批判性审视架构，定位风险、缺口与改进方向，输出按严重度排序的发现清单。

## 工作流程

1. 收集上下文与约束：目标、规模、SLA、团队、技术栈、部署/成本、合规要求。
2. 通过工具检索代码与文档，建立当前架构视图：模块/边界、数据流、依赖方向、部署拓扑。
3. 按评估维度逐项检查，记录证据与影响，避免臆测。
4. 为每条问题给出改进方向，避免引入新的重型框架与跨模块隐式耦合。
5. 关键信息缺失时先提问，再输出最终清单。

## 评估维度清单

### DDD 与边界

- 确认 Bounded Context 是否清晰，是否存在上下文映射。
- 校验聚合边界是否合理，跨聚合一致性策略是否明确（事务/最终一致）。
- 检查领域模型是否贫血，是否泄露基础设施细节。
- 核对通用语言、共享内核与防腐层边界是否明确。

### 模块化与依赖

- 验证模块职责单一、边界清晰。
- 检查依赖方向是否单向，是否存在循环依赖。
- 识别共享代码导致的隐式耦合。
- 评估接口契约稳定性与演进策略。

### 数据与一致性

- 识别读写模型边界与关键事务需求。
- 检查幂等、重试、补偿策略是否完整。
- 明确数据所有权与同步机制（事件/CDC/同步 API）。

### 接口与集成

- 检查 API/事件契约是否版本化与可回滚。
- 验证失败处理、超时、限流、降级策略。
- 审视可观测性：日志、指标、追踪是否覆盖关键路径。

### Python 后端

- 校验并发模型与 I/O 类型是否匹配（async/线程/进程）。
- 检查任务编排/队列/后台作业的边界与一致性策略。
- 关注配置管理、依赖注入与可测试性。

### 前端

- 检查状态管理范围与数据流边界。
- 核对路由/模块拆分与依赖边界。
- 评估性能与缓存策略（SSR/CSR/ISR）。
- 审视安全基线（XSS/CSRF/权限）。

### 运行与演进

- 校验部署拓扑与环境隔离策略。
- 检查回滚、灰度、迁移策略是否可执行。
- 评估容量规划与成本控制风险。

## 输出格式（严格）

按严重度降序输出要点清单，单条格式如下：

- [Blocker|High|Medium|Low] 问题：... 证据：... 影响：... 改进方向：...
